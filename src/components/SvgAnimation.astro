---
const { delay = 0.2, bottom = "0px" } = Astro.props;
---

<script>
  import { animate, inView } from "motion";

  const keyframes = {
    pathLength: [0, 1],
    fill: ["rgba(87, 113, 140, 0)", "rgba(87, 113, 140, 1)"],
  };

  inView(
    ".svg-animation",
    (element, info) => {
      const item = element.querySelectorAll("path");
      const delay = element?.getAttribute("data-delay");

      item[0].classList.add("svg-item");

      const animation = animate(item[0], keyframes, {
        duration: 0.8,
        ease: [0.5, 0, 0, 1], // почему-то ошибка из-за этой строки
        delay: Number(delay),
      });
      animation.play();
      return () => {
        animate(item[0], { pathLength: [1, 0] }, { instant: true });
      };
    },
    { amount: 0.5 }
  );
</script>
<span class="svg-animation underline-draw" data-delay={{ delay }}>
  <slot />
</span>

<style is:global define:vars={{ bottom: bottom }}>
  .underline-draw {
    bottom: var(--bottom);
  }
  @media (max-width: 755px) {
    .svg-animation > svg {
      width: 90%;
    }
  }
</style>
